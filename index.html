<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAS - Sistem Informasi Manajemen</title>
    <style>
        :root {
            --primary-color: #004aad;
            --secondary-color: #f4f4f4;
            --text-color: #333;
            --border-color: #ddd;
            --success-color: #28a745;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e9ecef;
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding-bottom: 60px;
        }

        /* Header & Timer */
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timer-box {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 150px;
            text-align: center;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* Identity Section */
        .card {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
            box-sizing: border-box; 
        }

        /* Questions */
        .question-item {
            background: white;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .q-number {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        textarea {
            height: 150px;
            resize: vertical;
            margin-top: 10px;
            font-family: 'Courier New', Courier, monospace;
        }

        /* Buttons */
        .btn {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1rem;
            width: 100%;
            transition: background 0.3s;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: #003380;
        }

        .btn-toggle-key {
            background-color: #6c757d;
            font-size: 0.9rem;
            padding: 0.8rem;
        }
        
        .btn-toggle-key:hover {
            background-color: #5a6268;
        }

        /* Answer Key (Hidden by default) */
        .answer-key {
            display: none;
            margin-top: 1rem;
            padding: 1rem;
            background-color: #e8f4ff;
            border: 1px dashed #004aad;
            border-radius: 5px;
            color: #003380;
        }

        .info-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            text-align: center;
        }
    </style>
</head>
<body>

<header>
    <div>
        <h1 style="margin:0; font-size: 1.5rem;">UAS: Sistem Informasi Manajemen</h1>
        <small>Dosen Pengampu: H. Pandiangan</small>
    </div>
    <div class="timer-box" id="timer">Sisa Waktu: 45:00</div>
</header>

<div class="container">
    <div class="card">
        <h2 style="margin-top:0;">Identitas Mahasiswa</h2>
        <div class="form-group">
            <label for="nama">Nama Lengkap:</label>
            <input type="text" id="nama" placeholder="Masukkan nama lengkap Anda">
        </div>
        <div class="form-group">
            <label for="nim">NIM:</label>
            <input type="text" id="nim" placeholder="Masukkan NIM Anda">
        </div>
    </div>

    <form id="examForm">
        <div class="question-item">
            <span class="q-number">Soal No. 1</span>
            <p id="qtext1">Jelaskan definisi Sistem Informasi Manajemen (SIM) serta sebutkan dan jelaskan lima komponen utama pembentuk sistem informasi!</p>
            <textarea name="q1" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> SIM adalah kumpulan komponen terintegrasi untuk mengumpulkan, memproses, dan menyediakan informasi guna mendukung keputusan. 5 Komponen: Hardware, Software, Data, Prosedur, Manusia (People).
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 2</span>
            <p id="qtext2">Dalam konteks strategi bisnis, apa yang dimaksud dengan <em>Businessâ€“IT Alignment</em> dan mengapa hal tersebut penting bagi organisasi modern?</p>
            <textarea name="q2" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Keselarasan antara strategi TI dan tujuan bisnis. Penting untuk produktivitas (naik 20-25%), inovasi cepat, dan daya saing di era digital.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 3</span>
            <p id="qtext3">Jelaskan perbedaan mendasar antara <em>E-Business</em> dan <em>E-Commerce</em>, serta sebutkan sistem informasi apa saja yang dibutuhkan untuk mendukung <em>E-Business</em>!</p>
            <textarea name="q3" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> E-Commerce (fokus transaksi jual-beli) adalah bagian dari E-Business (cakupan luas termasuk kolaborasi internal & mitra). Sistem pendukung: ERP, CRM, SCM, DSS, KMS.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 4</span>
            <p id="qtext4">Analisis bagaimana Sistem Informasi dapat meningkatkan pengambilan keputusan manajerial dan menjadi sumber keunggulan kompetitif bagi perusahaan!</p>
            <textarea name="q4" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Menyediakan data real-time/akurat untuk prediksi tren. Keunggulan kompetitif didapat dari efisiensi operasional, respon cepat pasar, dan layanan pelanggan unggul.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 5</span>
            <p id="qtext5">Uraikan apa yang dimaksud dengan Sistem Informasi Pemasaran (SIP) dan jelaskan empat tujuan utama dari penerapan SIP yang efektif!</p>
            <textarea name="q5" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Sistem integrasi orang/prosedur untuk data pemasaran. 4 Tujuan: Info akurat, Dukungan keputusan (4P), Pemahaman tren pasar, Efisiensi pemasaran.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 6</span>
            <p id="qtext6">Jelaskan apa itu <em>Enterprise Resource Planning</em> (ERP) dan bagaimana peran strategisnya dalam implementasi <em>E-Business</em>!</p>
            <textarea name="q6" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Sistem terintegrasi mengelola seluruh sumber daya perusahaan. Peran: Data real-time end-to-end, otomasi alur kerja, integrasi dengan e-commerce, efisiensi biaya.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 7</span>
            <p id="qtext7">Infrastruktur TI merupakan fondasi digital bagi organisasi modern. Sebutkan komponen-komponen utama infrastruktur TI dan jelaskan tren teknologi terkini yang mempengaruhinya!</p>
            <textarea name="q7" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Komponen: Hardware, OS, Software App, Data Storage, Network, Internet Platform. Tren: Cloud Computing, AI Management, Platform Integration.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 8</span>
            <p id="qtext8">Dalam pengembangan sistem informasi, dikenal beberapa metodologi seperti <em>Waterfall</em> dan <em>Agile</em>. Jelaskan karakteristik utama dan kapan waktu yang tepat untuk menggunakan masing-masing model tersebut!</p>
            <textarea name="q8" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Waterfall (Linear/Berurutan) cocok untuk kebutuhan jelas/stabil. Agile (Iteratif/Fleksibel) cocok untuk proyek butuh inovasi cepat dan kebutuhan dinamis.
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 9</span>
            <p id="qtext9">Sebutkan dan jelaskan isu-isu sosial dan etika utama yang muncul akibat perkembangan Sistem Informasi!</p>
            <textarea name="q9" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Privasi Data (penyalahgunaan info), Keamanan Informasi (peretasan), Digital Divide (kesenjangan akses teknologi).
            </div>
        </div>

        <div class="question-item">
            <span class="q-number">Soal No. 10</span>
            <p id="qtext10">Berdasarkan studi kasus peluncuran produk baru (misal: Smartwatch), bagaimana Sistem Informasi Pemasaran (SIP) berperan dalam tahap Pra-Peluncuran, Peluncuran, dan Pasca-Peluncuran?</p>
            <textarea name="q10" placeholder="Tulis jawaban Anda di sini..."></textarea>
            <div class="answer-key">
                <strong>Kunci Jawaban:</strong> Pra: Riset pasar/Analisis pesaing. Saat Peluncuran: Monitor stok real-time/Targeting iklan. Pasca: Analisis data penjualan/Feedback kepuasan pelanggan.
            </div>
        </div>

        <hr style="margin: 30px 0; border: 0; border-top: 1px solid #ddd;">

        <button type="button" class="btn" onclick="submitExam()">Kirim & Unduh Jawaban (Word)</button>
        <p class="info-text">*File jawaban akan terunduh otomatis. Kirim file tersebut ke Dosen.</p>
        
        <button type="button" class="btn btn-toggle-key" onclick="toggleKeys()">Mode Dosen (Tampilkan Kunci Jawaban)</button>
    </form>
</div>

<script>
    // 1. Timer Functionality
    let timeLimit = 60 * 60; // 60 minutes in seconds
    const timerDisplay = document.getElementById('timer');

    const countdown = setInterval(() => {
        const minutes = Math.floor(timeLimit / 60);
        let seconds = timeLimit % 60;

        seconds = seconds < 10 ? '0' + seconds : seconds;
        timerDisplay.textContent = `Sisa Waktu: ${minutes}:${seconds}`;

        if (timeLimit > 0) {
            timeLimit--;
        } else {
            clearInterval(countdown);
            alert("Waktu Habis! Jawaban akan otomatis diunduh.");
            submitExam(); // Auto submit when time is up
        }
    }, 1000);

    // 2. Submit & Download Functionality (Microsoft Word .doc)
    function submitExam() {
        // Ambil Data Mahasiswa
        const nama = document.getElementById('nama').value;
        const nim = document.getElementById('nim').value;

        if(!nama || !nim) {
            alert("Mohon isi Nama dan NIM terlebih dahulu!");
            // Scroll to top smoothly
            window.scrollTo({top: 0, behavior: 'smooth'});
            return;
        }

        // Konfirmasi
        const confirmSubmit = confirm("Apakah Anda yakin ingin menyelesaikan ujian? Jawaban akan diunduh ke dalam file Microsoft Word.");
        if (!confirmSubmit) return;

        // Membuat Header Dokumen Word (HTML Based)
        let header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                     "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                     "xmlns='http://www.w3.org/TR/REC-html40'>" +
                     "<head><meta charset='utf-8'><title>Lembar Jawaban UAS</title>" +
                     "<style>" +
                     "body { font-family: 'Times New Roman', serif; font-size: 12pt; }" +
                     "h1 { text-align: center; font-size: 16pt; margin-bottom: 5px; }" +
                     "h2 { text-align: center; font-size: 14pt; margin-top: 0; }" +
                     "p { margin: 5px 0; }" +
                     ".identity-table { width: 100%; margin-bottom: 20px; border-bottom: 2px solid black; padding-bottom: 10px; }" +
                     ".question { font-weight: bold; margin-top: 15px; }" +
                     ".answer { margin-left: 20px; text-align: justify; }" +
                     "</style></head><body>";

        let content = header;

        // Header Dokumen (Identitas)
        content += "<h1>LEMBAR JAWABAN UAS</h1>";
        content += "<h2>Sistem Informasi Manajemen</h2>";
        
        content += "<div class='identity-table'>";
        content += "<p><strong>Nama Mahasiswa :</strong> " + nama + "</p>";
        content += "<p><strong>NIM            :</strong> " + nim + "</p>";
        content += "<p><strong>Waktu Submit   :</strong> " + new Date().toLocaleString() + "</p>";
        content += "</div>";

        // Loop untuk mengambil jawaban soal no 1 sampai 10
        for (let i = 1; i <= 10; i++) {
            // Ambil teks soal (opsional, agar file word lebih rapi ada soalnya)
            // Di HTML saya tambahkan id="qtext1" dst pada tag <p> soal agar bisa diambil teksnya
            const questionElement = document.getElementById(`qtext${i}`);
            // Jika ID belum ditambahkan manual di HTML atas, kita gunakan fallback sederhana:
            const questionText = questionElement ? questionElement.innerText : `Pertanyaan No. ${i}`;
            
            const textArea = document.getElementsByName(`q${i}`)[0];
            // Ganti baris baru (\n) menjadi <br> agar terbaca di Word
            const rawAnswer = textArea ? textArea.value : "";
            const formattedAnswer = rawAnswer.replace(/\n/g, "<br>");
            
            content += `<p class='question'>Soal No. ${i}:</p>`;
            content += `<p><em>${questionText}</em></p>`; // Menampilkan soal di word
            content += `<div class='answer'>${formattedAnswer.trim() ? formattedAnswer : "[TIDAK DIJAWAB]"}</div>`;
            content += "<hr style='border: 0; border-top: 1px dashed #ccc;'>";
        }

        content += "</body></html>";

        // Proses Pembuatan File Download (.doc)
        // Menggunakan MIME type ms-word agar dikenali browser sebagai file Word
        const blob = new Blob(['\ufeff', content], {
            type: 'application/msword'
        });
        
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        
        link.href = url;
        const safeNama = nama.replace(/[^a-z0-9]/gi, '_').toLowerCase();
        // Ekstensi .doc lebih kompatibel dengan metode HTML-to-Word sederhana ini
        link.download = `UAS_SIM_${safeNama}_${nim}.doc`; 
        
        document.body.appendChild(link);
        link.click();
        
        document.body.removeChild(link);
        
        alert("Jawaban BERHASIL diunduh sebagai file Word! \n\nCatatan: Jika muncul peringatan saat membuka file di Word, pilih 'Yes' (File aman).");
    }

    // 3. Toggle Answer Key for Lecturer
    function toggleKeys() {
        const password = prompt("Masukkan Password Dosen untuk melihat kunci jawaban (Default: admin):");
        if(password === "admin") {
            const keys = document.querySelectorAll('.answer-key');
            let isVisible = false;
            
            keys.forEach(key => {
                if (key.style.display === "block") {
                    key.style.display = "none";
                    isVisible = false;
                } else {
                    key.style.display = "block";
                    isVisible = true;
                }
            });

            if(isVisible) {
                alert("Mode Dosen Aktif: Kunci Jawaban Ditampilkan.");
            } else {
                alert("Mode Dosen Non-Aktif: Kunci Jawaban Disembunyikan.");
            }
        } else {
            alert("Password Salah!");
        }
    }
</script>

</body>

</html>
